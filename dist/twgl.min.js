/**
 * @license twgl.js Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT.
 * see: http://github.com/greggman/twgl.js for details
 */
/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
!function(root,factory){"function"==typeof define&&define.amd?define([],factory):root.twgl=factory()}(this,function(){var requirejs,require,define;return function(undef){function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&"."===name.charAt(0))if(baseName){for(name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),name=baseParts.slice(0,baseParts.length-1).concat(name),i=0;i<name.length;i+=1)if(part=name[i],"."===part)name.splice(i,1),i-=1;else if(".."===part){if(1===i&&(".."===name[2]||".."===name[0]))break;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}else 0===name.indexOf("./")&&(name=name.substring(2));if((baseParts||starMap)&&map){for(nameParts=name.split("/"),i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=map[baseParts.slice(0,j).join("/")],mapValue&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);return"string"!=typeof args[0]&&1===args.length&&args.push(null),req.apply(undef,args.concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];return name=parts[1],prefix&&(prefix=normalize(prefix,relName),plugin=callDep(prefix)),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,makeNormalize(relName)):normalize(name,relName):(name=normalize(name,relName),parts=splitPrefix(name),prefix=parts[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return"undefined"!=typeof e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,usingExports,args=[],callbackType=typeof callback;if(relName=relName||name,"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if(map=makeMap(deps[i],relName),depName=map.f,"require"===depName)args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:ret===undef&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,callback).f);if(!deps.splice){if(config=deps,config.deps&&req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=undef}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},4),req},req.config=function(cfg){return req(cfg)},requirejs._defined=defined,define=function(name,deps,callback){if("string"!=typeof name)throw new Error("See almond README: incorrect module build, no module name");deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])},define.amd={jQuery:!0}}(),define("node_modules/almond/almond.js",function(){}),define("twgl/twgl",[],function(){function setDefaultTextureColor(color){defaultTextureColor=new Uint8Array([255*color[0],255*color[1],255*color[2],255*color[3]])}function setAttributePrefix(prefix){defaultAttribPrefix=prefix}function create3DContext(canvas,opt_attribs){for(var names=["webgl","experimental-webgl"],context=null,ii=0;ii<names.length;++ii){try{context=canvas.getContext(names[ii],opt_attribs)}catch(e){}if(context)break}return context}function getWebGLContext(canvas,opt_attribs){var gl=create3DContext(canvas,opt_attribs);return gl}function loadShader(gl,shaderSource,shaderType,opt_errorCallback){var errFn=opt_errorCallback||error,shader=gl.createShader(shaderType);gl.shaderSource(shader,shaderSource),gl.compileShader(shader);var compiled=gl.getShaderParameter(shader,gl.COMPILE_STATUS);if(!compiled){var lastError=gl.getShaderInfoLog(shader);return errFn("*** Error compiling shader '"+shader+"':"+lastError),gl.deleteShader(shader),null}return shader}function createProgram(gl,shaders,opt_attribs,opt_locations,opt_errorCallback){var errFn=opt_errorCallback||error,program=gl.createProgram();shaders.forEach(function(shader){gl.attachShader(program,shader)}),opt_attribs&&opt_attribs.forEach(function(attrib,ndx){gl.bindAttribLocation(program,opt_locations?opt_locations[ndx]:ndx,attrib)}),gl.linkProgram(program);var linked=gl.getProgramParameter(program,gl.LINK_STATUS);if(!linked){var lastError=gl.getProgramInfoLog(program);return errFn("Error in program linking:"+lastError),gl.deleteProgram(program),null}return program}function createShaderFromScript(gl,scriptId,opt_shaderType,opt_errorCallback){var shaderType,shaderSource="",shaderScript=document.getElementById(scriptId);if(!shaderScript)throw"*** Error: unknown script element"+scriptId;if(shaderSource=shaderScript.text,!opt_shaderType)if("x-shader/x-vertex"===shaderScript.type)shaderType=gl.VERTEX_SHADER;else if("x-shader/x-fragment"===shaderScript.type)shaderType=gl.FRAGMENT_SHADER;else if(shaderType!==gl.VERTEX_SHADER&&shaderType!==gl.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return loadShader(gl,shaderSource,opt_shaderType?opt_shaderType:shaderType,opt_errorCallback)}function createProgramFromScripts(gl,shaderScriptIds,opt_attribs,opt_locations,opt_errorCallback){for(var shaders=[],ii=0;ii<shaderScriptIds.length;++ii){var shader=createShaderFromScript(gl,shaderScriptIds[ii],gl[defaultShaderType[ii]],opt_errorCallback);if(!shader)return null;shaders.push(shader)}return createProgram(gl,shaders,opt_attribs,opt_locations,opt_errorCallback)}function createProgramFromSources(gl,shaderSources,opt_attribs,opt_locations,opt_errorCallback){for(var shaders=[],ii=0;ii<shaderSources.length;++ii){var shader=loadShader(gl,shaderSources[ii],gl[defaultShaderType[ii]],opt_errorCallback);if(!shader)return null;shaders.push(shader)}return createProgram(gl,shaders,opt_attribs,opt_locations,opt_errorCallback)}function getBindPointForSamplerType(gl,type){return type===gl.SAMPLER_2D?gl.TEXTURE_2D:type===gl.SAMPLER_CUBE?gl.TEXTURE_CUBE_MAP:void 0}function createUniformSetters(gl,program){function createUniformSetter(program,uniformInfo){var location=gl.getUniformLocation(program,uniformInfo.name),type=uniformInfo.type,isArray=uniformInfo.size>1&&"[0]"===uniformInfo.name.substr(-3);if(type===gl.FLOAT&&isArray)return function(v){gl.uniform1fv(location,v)};if(type===gl.FLOAT)return function(v){gl.uniform1f(location,v)};if(type===gl.FLOAT_VEC2)return function(v){gl.uniform2fv(location,v)};if(type===gl.FLOAT_VEC3)return function(v){gl.uniform3fv(location,v)};if(type===gl.FLOAT_VEC4)return function(v){gl.uniform4fv(location,v)};if(type===gl.INT&&isArray)return function(v){gl.uniform1iv(location,v)};if(type===gl.INT)return function(v){gl.uniform1i(location,v)};if(type===gl.INT_VEC2)return function(v){gl.uniform2iv(location,v)};if(type===gl.INT_VEC3)return function(v){gl.uniform3iv(location,v)};if(type===gl.INT_VEC4)return function(v){gl.uniform4iv(location,v)};if(type===gl.BOOL)return function(v){gl.uniform1iv(location,v)};if(type===gl.BOOL_VEC2)return function(v){gl.uniform2iv(location,v)};if(type===gl.BOOL_VEC3)return function(v){gl.uniform3iv(location,v)};if(type===gl.BOOL_VEC4)return function(v){gl.uniform4iv(location,v)};if(type===gl.FLOAT_MAT2)return function(v){gl.uniformMatrix2fv(location,!1,v)};if(type===gl.FLOAT_MAT3)return function(v){gl.uniformMatrix3fv(location,!1,v)};if(type===gl.FLOAT_MAT4)return function(v){gl.uniformMatrix4fv(location,!1,v)};if((type===gl.SAMPLER_2D||type===gl.SAMPLER_CUBE)&&isArray){for(var units=[],ii=0;ii<info.size;++ii)units.push(textureUnit++);return function(bindPoint,units){return function(textures){gl.uniform1iv(location,units),textures.forEach(function(texture,index){gl.activeTexture(gl.TEXTURE0+units[index]),gl.bindTexture(bindPoint,tetxure)})}}(getBindPointForSamplerType(gl,type),units)}if(type===gl.SAMPLER_2D||type===gl.SAMPLER_CUBE)return function(bindPoint,unit){return function(texture){gl.uniform1i(location,unit),gl.activeTexture(gl.TEXTURE0+unit),gl.bindTexture(bindPoint,texture)}}(getBindPointForSamplerType(gl,type),textureUnit++);throw"unknown type: 0x"+type.toString(16)}for(var textureUnit=0,uniformSetters={},numUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),ii=0;numUniforms>ii;++ii){var uniformInfo=gl.getActiveUniform(program,ii);if(!uniformInfo)break;var name=uniformInfo.name;"[0]"===name.substr(-3)&&(name=name.substr(0,name.length-3));var setter=createUniformSetter(program,uniformInfo);uniformSetters[name]=setter}return uniformSetters}function setUniforms(setters,values){setters=setters.uniformSetters||setters;for(var name in values){var setter=setters[name];setter&&setter(values[name])}}function createAttributeSetters(gl,program){function createAttribSetter(index){return function(b){gl.bindBuffer(gl.ARRAY_BUFFER,b.buffer),gl.enableVertexAttribArray(index),gl.vertexAttribPointer(index,b.numComponents||b.size,b.type||gl.FLOAT,b.normalize||!1,b.stride||0,b.offset||0)}}for(var attribSetters={},numAttribs=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),ii=0;numAttribs>ii;++ii){var attribInfo=gl.getActiveAttrib(program,ii);if(!attribInfo)break;var index=gl.getAttribLocation(program,attribInfo.name);attribSetters[attribInfo.name]=createAttribSetter(index)}return attribSetters}function setAttributes(setters,buffers){for(var name in buffers){var setter=setters[name];setter&&setter(buffers[name])}}function setBuffersAndAttributes(gl,programInfo,buffers){setAttributes(programInfo.attribSetters||programInfo,buffers.attribs),buffers.indices&&gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,buffers.indices)}function createProgramInfo(gl,shaderSources,opt_attribs,opt_locations,opt_errorCallback){shaderSources=shaderSources.map(function(source){var script=document.getElementById(source);return script?script.text:source});var program=createProgramFromSources(gl,shaderSources,opt_attribs,opt_locations,opt_errorCallback);if(!program)return null;var uniformSetters=createUniformSetters(gl,program),attribSetters=createAttributeSetters(gl,program);return{program:program,uniformSetters:uniformSetters,attribSetters:attribSetters}}function resizeCanvasToDisplaySize(canvas,multiplier){multiplier=multiplier||1,multiplier=Math.max(1,multiplier);var width=canvas.clientWidth*multiplier|0,height=canvas.clientHeight*multiplier|0;return canvas.width!==width||canvas.height!==height?(canvas.width=width,canvas.height=height,!0):!1}function createBufferFromTypedArray(gl,array,type,drawType){type=type||gl.ARRAY_BUFFER;var buffer=gl.createBuffer();return gl.bindBuffer(type,buffer),gl.bufferData(type,array,drawType||gl.STATIC_DRAW),buffer}function isIndices(name){return"indices"===name}function getGLTypeForTypedArray(gl,typedArray){if(typedArray instanceof Int8Array)return gl.BYTE;if(typedArray instanceof Uint8Array)return gl.UNSIGNED_BYTE;if(typedArray instanceof Int16Array)return gl.SHORT;if(typedArray instanceof Uint16Array)return gl.UNSIGNED_SHORT;if(typedArray instanceof Int32Array)return gl.INT;if(typedArray instanceof Uint32Array)return gl.UNSIGNED_INT;if(typedArray instanceof Float32Array)return gl.FLOAT;throw"unsupported typed array type"}function getTypedArrayTypeForGLType(gl,type){switch(type){case gl.BYTE:return Int8Array;case gl.UNSIGNED_BYTE:return Uint8Array;case gl.SHORT:return Int16Array;case gl.UNSIGNED_SHORT:return Uint16Array;case gl.INT:return Int32Array;case gl.UNSIGNED_INT:return Uint32Array;case gl.FLOAT:return Float32Array;default:throw"unknown gl type"}}function getNormalizationForTypedArray(typedArray){return typedArray instanceof Int8Array?!0:typedArray instanceof Uint8Array?!0:!1}function isArrayBuffer(a){return a.buffer&&a.buffer instanceof ArrayBuffer}function guessNumComponentsFromName(name,length){var numComponents;if(numComponents=name.indexOf("coord")>=0?2:name.indexOf("color")>=0?4:3,length%numComponents>0)throw"can not guess numComponents. You should specify it.";return numComponents}function makeTypedArray(array,name){if(isArrayBuffer(array))return array;Array.isArray(array)&&(array={data:array});var Type=array.type;return Type||(Type="indices"===name?Uint16Array:Float32Array),new Type(array.data)}function createAttribsFromArrays(gl,arrays){var attribs={};return Object.keys(arrays).forEach(function(arrayName){if(!isIndices(arrayName)){var array=arrays[arrayName],attribName=array.attrib||array.name||array.attribName||defaultAttribPrefix+arrayName,typedArray=makeTypedArray(array,arrayName);attribs[attribName]={buffer:createBufferFromTypedArray(gl,typedArray),numComponents:array.numComponents||array.size||guessNumComponentsFromName(arrayName),type:getGLTypeForTypedArray(gl,typedArray),normalize:getNormalizationForTypedArray(typedArray)}}}),attribs}function createBufferInfoFromArrays(gl,arrays){var bufferInfo={attribs:createAttribsFromArrays(gl,arrays)},indices=arrays.indices;return indices?(indices=makeTypedArray(indices,"indices"),bufferInfo.indices=createBufferFromTypedArray(gl,indices,gl.ELEMENT_ARRAY_BUFFER),bufferInfo.numElements=indices.length):bufferInfo.numElements=getNumElementsFromNonIndexedArrays(arrays),bufferInfo}function createBuffersFromArrays(gl,arrays){var buffers={};return Object.keys(arrays).forEach(function(key){var type="indices"===key?gl.ELEMENT_ARRAY_BUFFER:gl.ARRAY_BUFFER,array=makeTypedArray(arrays[key],name);buffers[key]=createBufferFromTypedArray(gl,array,type)}),buffers}function drawBufferInfo(gl,type,bufferInfo,count,offset){var indices=bufferInfo.indices,numElements=void 0===count?bufferInfo.numElements:count;offset=void 0===offset?offset:0,indices?gl.drawElements(type,numElements,gl.UNSIGNED_SHORT,offset):gl.drawArrays(type,offset,numElements)}function drawObjectList(gl,objectsToDraw){var lastUsedProgramInfo=null,lastUsedBufferInfo=null;objectsToDraw.forEach(function(object){var programInfo=object.programInfo,bufferInfo=object.bufferInfo;programInfo!==lastUsedProgramInfo&&(lastUsedProgramInfo=programInfo,gl.useProgram(programInfo.program)),bufferInfo!==lastUsedBufferInfo&&(lastUsedBufferInfo=bufferInfo,setBuffersAndAttributes(gl,programInfo,bufferInfo)),setUniforms(programInfo,object.uniforms),drawBufferInfo(gl,object.type||gl.TRIANGLES,bufferInfo)})}function savePackState(gl,options){void 0!==options.colorspaceConversion&&(lastPackState.colorSpaceConversion=gl.getParameter(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL)),void 0!==options.premultiplyAlpha&&(lastPackState.premultiplyAlpha=gl.getParameter(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL)),void 0!==options.flipY&&(lastPackState.flipY=gl.getParameter(gl.UNPACK_FLIP_Y_WEBGL))}function restorePackState(gl,options){void 0!==options.colorspaceConversion&&gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,lastPackState.colorSpaceConversion),void 0!==options.premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,lastPackState.premultiplyAlpha),void 0!==options.flipY&&gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,lastPackState.flipY)}function setTextureParameters(gl,tex,options){var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex),options.min&&gl.texParameteri(target,gl.TEXTURE_MIN_FILTER,options.min),options.mag&&gl.texParameteri(target,gl.TEXTURE_MAG_FILTER,options.mag),options.wrap&&(gl.texParameteri(target,gl.TEXTURE_WRAP_S,options.wrap),gl.texParameteri(target,gl.TEXTURE_WRAP_T,options.wrap)),options.wrapS&&gl.texParameteri(target,gl.TEXTURE_WRAP_S,options.wrapS),options.wrapT&&gl.texParameteri(target,gl.TEXTURE_WRAP_T,options.wrapT)}function make1Pixel(color){return color=color||defaultTextureColor,isArrayBuffer(color)?color:new Uint8Array([255*color[0],255*color[1],255*color[2],255*color[3]])}function isPowerOf2(value){return 0===(value&value-1)}function setTextureFilteringForSize(gl,tex,options,width,height){options=otions||defaultTextureOptions;var target=options.target||gl.TEXTURE_2D;width=width||options.width,height=height||options.height,gl.bindTexture(target,tex),isPowerOf2(width)&&isPowerOf2(height)?gl.generateMipmap(target):(gl.texParameteri(target,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(target,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(target,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE))}function getCubeFaceOrder(gl,options){return options.cubeFaceOrder||[gl.TEXTURE_CUBE_MAP_POSITIVE_X,gl.TEXTURE_CUBE_MAP_NEGATIVE_X,gl.TEXTURE_CUBE_MAP_POSITIVE_Y,gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,gl.TEXTURE_CUBE_MAP_POSITIVE_Z,gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function shallowCopy(src){var dst={};return Object.keys(src).forEach(function(key){dst[key]=src[key]}),dst}function loadImage(url,callback){var img=new Image;return img.onerror=function(){var msg="couldn't load image: "+url;error(msg),callback(msg,img)},img.onload=function(){callback(null,img)},img.src=url,img}function setTextureTo1PixelColor(gl,tex,options){options=options||defaultTextureOptions;var target=options.target||gl.TEXTURE_2D;if(gl.bindTexture(target,tex),options.color!==!1){var color=make1Pixel(options.color);if(target===gl.TEXTURE_CUBE_MAP)for(var ii=0;6>ii;++ii)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+ii,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,color);else gl.texImage2D(target,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,color)}}function loadTextureFromUrl(gl,tex,options,callback){return options=options||defaultTextureOptions,setTextureTo1PixelColor(gl,tex,options),options=shallowCopy(options),img=loadImage(options.src,function(err,img){err?callback(err,tex,img):(setTextureFromElement(gl,tex,img,options),callback(null,tex,img))}),img}function loadCubemapFromUrls(gl,tex,options,callback){function uploadImg(faceTarget){return function(err,img){--numToLoad,err?errors.push(err):img.width!==img.height?errors.push("cubemap face img is not a square: "+img.src):(savePackState(gl,options),gl.bindTexture(target,tex),gl.texImage2D(faceTarget,0,format,format,type,img),5===numToLoad&&faces.forEach(function(otherTarget){otherTarget!==faceTarget&&gl.texImage2D(otherTarget,0,format,format,type,img)}),restorePackState(gl,options),gl.generateMipmap(target)),0===numToLoad&&callback&&callback(errors.length?errors:void 0,imgs,tex)}}var urls=options.src;if(6!==urls.length)throw"there must be 6 urls for a cubemap";var format=options.format||gl.RGBA,type=options.type||gl.UNSIGNED_BYTE,target=options.target||gl.TEXTURE_2D;if(target!==gl.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";setTextureTo1PixelColor(gl,tex,options),options=shallowCopy(options);var imgs,numToLoad=6,errors=[],faces=getCubeFaceOrder(gl,options);imgs=urls.map(function(url,ndx){return loadImage(url,uploadImg(faces[ndx]))})}function getNumComponentsForFormat(gl,format){switch(format){case gl.ALPHA:case gl.LUMINANCE:return 1;case gl.LUMINANCE_ALPHA:return 2;case gl.RGB:return 3;case gl.RGBA:return 4;default:throw"unknown type: "+type}}function getTextureTypeForArrayType(gl,src){return isArrayBuffer(src)?getGLTypeForTypedArray(gl,src):gl.UNSIGNED_BYTE}function setTextureFromArray(gl,tex,src,options){options=options||defaultTextureOptions;var target=options.target||gl.TEXTURE_2D,width=options.width,height=options.height,format=options.format||gl.RGBA,type=options.type||getTextureTypeForArrayType(gl,src),numComponents=getNumComponentsForFormat(gl,format),numElements=src.length/numComponents;if(numElements%1)throw"length wrong size of format: "+glEnumToString(gl,format);if(width||height){if(height){if(!width&&(width=numElements/height,width%1))throw"can't guess width"}else if(height=numElements/width,height%1)throw"can't guess height"}else{var size=Math.sqrt(numElements);size%1===0?(width=size,height=size):(width=numElements,height=1)}if(!isArrayBuffer(src)){var Type=getTypedArrayTypeForGLType(gl,type);src=new Type(src)}gl.pixelStorei(gl.UNPACK_ALIGNMENT,options.unpackAlignment||1),savePackState(gl,options),gl.texImage2D(target,0,format,width,height,0,format,type,src),restorePackState(gl,options)}function setEmptyTexture(gl,tex,options){var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex);var format=options.format||gl.RGBA,type=options.type||gl.UNSIGNED_BYTE;if(savePackState(gl,options),target===gl.TEXTURE_CUBE_MAP)for(var ii=0;6>ii;++ii)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+ii,0,format,options.width,options.height,0,format,type,null);else gl.texImage2D(target,0,format,options.width,options.height,0,format,type,null);restorePackState(gl,options)}function createTexture(gl,options,callback){options=options||defaultTextureOptions;var tex=gl.createTexture(),target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex),setTextureParameters(gl,tex,options);var src=options.src;if(src)if("string"==typeof src)loadTextureFromUrl(gl,tex,options,callback);else if(isArrayBuffer(src)||Array.isArray(src)&&"number"==typeof src[0])setTextureFromArray(gl,tex,src,options);else if(Array.isArray(src)&&"string"==typeof src[0])loadCubemapFromUrls(gl,tex,options,callback);else{if(!(src instanceof HTMLElement))throw"unsupported src type";setTextureFromElement(gl,tex,src,options)}else setEmptyTexture(gl,tex,options);return tex}function isAsyncSrc(src){return"string"==typeof src||Array.isArray(src)&&"string"==typeof src[0]}function createTextures(gl,textureOptions,callback){function finishedDownloading(err){--numDownloading,err&&errors.push(err),0===numDownloading&&callback&&callback(errors.length?errors:void 0,textureOptions)}var numDownloading=0,errors=[],textures={};return Object.keys(textureOptions).forEach(function(name){var options=textureOptions[name],onLoadFn=void 0;isAsyncSrc(options.src)&&(onLoadFn=finishedDownloading,++numDownloading),textures[name]=createTexture(gl,options,onLoadFn)}),textures}var error=window.console&&window.console.error?window.console.error.bind(window.console):function(){},defaultAttribPrefix="",defaultTextureColor=new Uint8Array([128,192,255,255]),defaultTextureOptions={},glEnumToString=function(){function init(gl){enums||(enums={},Object.keys(gl).forEach(function(key){"number"==typeof gl[key]&&(enums[gl[key]]=key)}))}var enums;return function(gl,value){return init(),enums[value]||"0x"+value.toString(16)}}(),defaultShaderType=["VERTEX_SHADER","FRAGMENT_SHADER"],getNumElementsFromNonIndexedArrays=function(){var positionKeys=["position","positions","a_position"];return function(arrays){for(var key,ii=0;ii<positionKeys.length&&(key=positionKeys[ii],!(key in arrays));++ii);ii===positionKeys.length&&(key=Object.keys(arrays)[0]);var array=arrays[key],length=array.length||array.data.length,numComponents=array.numComponents||guessNumComponentsFromName(key,length),numElements=length/numComponents;if(length%numComponents>0)throw"numComponents "+numComponent+" not correct for length "+length;return numElements}}(),lastPackState={},setTextureFromElement=function(){var ctx=document.createElement("canvas").getContext("2d");return function(gl,tex,element,options){options=options||defaultTextureOptions;var target=options.target||gl.TEXTURE_2D,width=element.width,height=element.height,format=options.format||gl.RGBA,type=options.type||gl.UNSIGNED_BYTE;if(savePackState(gl,options),gl.bindTexture(target,tex),target===gl.TEXTURE_CUBE_MAP){var size,slices,imgWidth=element.width,imgHeight=element.height;if(imgWidth/6===imgHeight)size=imgHeight,slices=[0,0,1,0,2,0,3,0,4,0,5,0];else if(imgHeight/6===imgWidth)size=imgWidth,slices=[0,0,0,1,0,2,0,3,0,4,0,5];else if(imgWidth/3===imgHeight/2)size=imgWidth/3,slices=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(imgWidth/2!==imgHeight/3)throw"can't figure out cube map from element: "+(element.src?element.src:element.nodeName);size=imgWidth/2,slices=[0,0,1,0,0,1,1,1,0,2,1,2]}var faces=getCubeFaceOrder(gl,options);ctx.canvas.width=size,ctx.canvas.height=size,width=size,height=size;for(var ii=0;6>ii;++ii){var xOffset=slices[2*ii+0]*size,yOffset=slices[2*ii+1]*size;ctx.drawImage(element,xOffset,yOffset,size,size,0,0,size,size),gl.texImage2D(faces[ii],0,format,format,type,ctx.canvas)}ctx.canvas.width=1,ctx.canvas.height=1}else gl.texImage2D(target,0,format,format,type,element);restorePackState(gl,options),options.auto!==!1&&setTextureFilteringForSize(gl,tex,options,width,height),setTextureParameters(gl,tex,options)}}();return{createAttribsFromArrays:createAttribsFromArrays,createBuffersFromArrays:createBuffersFromArrays,createBufferInfoFromArrays:createBufferInfoFromArrays,createAttributeSetters:createAttributeSetters,createProgram:createProgram,createProgramFromScripts:createProgramFromScripts,createProgramFromSources:createProgramFromSources,createProgramInfo:createProgramInfo,createUniformSetters:createUniformSetters,drawBufferInfo:drawBufferInfo,drawObjectList:drawObjectList,getWebGLContext:getWebGLContext,resizeCanvasToDisplaySize:resizeCanvasToDisplaySize,setAttributes:setAttributes,setAttributePrefix:setAttributePrefix,setBuffersAndAttributes:setBuffersAndAttributes,setUniforms:setUniforms,createTexture:createTexture,setEmptyTexture:setEmptyTexture,setTextureFromArray:setTextureFromArray,loadTextureFromUrl:loadTextureFromUrl,setTextureFromElement:setTextureFromElement,setTextureFilteringForSize:setTextureFilteringForSize,setTextureParameters:setTextureParameters,setDefaultTextureColor:setDefaultTextureColor,createTextures:createTextures}}),define("main",["twgl/twgl"],function(twgl){return twgl}),require(["main"],function(main){return main},void 0,!0),define("build/js/twgl-includer",function(){}),require("main")});